<ContentDialog
    x:Class="Sklad_2.Views.Dialogs.EditProductDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Upravit produkt"
    PrimaryButtonText="Uložit"
    CloseButtonText="Zrušit"
    DefaultButton="Primary">

    <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="600">
        <StackPanel Spacing="12" MinWidth="400">
            <!-- EAN (read-only for all) -->
            <TextBlock Text="EAN:" Style="{ThemeResource CaptionTextBlockStyle}"/>
            <TextBlock x:Name="EanText" Style="{ThemeResource BodyStrongTextBlockStyle}"/>

            <!-- Name (editable by all) -->
            <TextBox x:Name="NameBox" Header="Název"/>

            <!-- Brand (editable by all) -->
            <ComboBox x:Name="BrandCombo" Header="Značka (volitelné)" MinWidth="200" PlaceholderText="Vyberte značku..."/>

            <!-- Category (editable by all) -->
            <ComboBox x:Name="CategoryCombo" Header="Kategorie" MinWidth="200" PlaceholderText="Vyberte kategorii..."/>

            <!-- Description (editable by all) -->
            <TextBox x:Name="DescriptionBox"
                     Header="Popis"
                     TextWrapping="Wrap"
                     AcceptsReturn="True"
                     MinHeight="80"
                     MaxHeight="120"/>

            <!-- Image Section (editable by all) -->
            <TextBlock Text="Obrázek produktu" Style="{ThemeResource BodyStrongTextBlockStyle}" Margin="0,8,0,0"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Image Preview -->
                <Border Grid.Column="0"
                        Width="100" Height="100"
                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <Grid>
                        <!-- Placeholder icon -->
                        <FontIcon x:Name="PlaceholderIcon"
                                  Glyph="&#xE91B;"
                                  FontSize="32"
                                  Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                        <!-- Preview image -->
                        <Image x:Name="PreviewImage"
                               Stretch="Uniform"
                               Visibility="Collapsed"/>
                    </Grid>
                </Border>

                <!-- Buttons -->
                <StackPanel Grid.Column="1" Spacing="8" Margin="12,0,0,0" VerticalAlignment="Center">
                    <Button x:Name="SelectImageButton" Content="Vybrat obrázek" Click="SelectImageButton_Click"/>
                    <Button x:Name="RemoveImageButton" Content="Odstranit" Click="RemoveImageButton_Click" Visibility="Collapsed"/>
                </StackPanel>
            </Grid>

            <!-- Separator - Admin only section -->
            <Border x:Name="AdminSectionSeparator" Height="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" Margin="0,8"/>

            <!-- Admin-only section header -->
            <TextBlock x:Name="AdminSectionHeader"
                       Text="Cenové údaje (pouze Vlastník)"
                       Style="{ThemeResource BodyStrongTextBlockStyle}"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

            <!-- Purchase Price (admin only) -->
            <TextBox x:Name="PurchasePriceBox" Header="Nákupní cena (Kč)"/>

            <!-- Sale Price & Markup (admin only) -->
            <Grid x:Name="PriceMarkupGrid" ColumnSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="SalePriceBox" Grid.Column="0" Header="Prodejní cena (Kč)"/>
                <TextBox x:Name="MarkupBox" Grid.Column="1" Header="Marže (%)" Width="100"/>
            </Grid>

            <!-- Price display for non-admin (read-only) -->
            <StackPanel x:Name="PriceReadOnlyPanel" Spacing="8" Visibility="Collapsed">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Prodejní cena" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <TextBlock x:Name="SalePriceReadOnly" Grid.Column="1" FontWeight="SemiBold"/>
                </Grid>
            </StackPanel>

            <TextBlock x:Name="ErrorText"
                       Foreground="Red"
                       TextWrapping="Wrap"
                       Visibility="Collapsed"/>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
